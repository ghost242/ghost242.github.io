---
layout: post
title: 테스트 코드를 작성하는 과정
subtitle: 언제 누굴 대상으로 테스트를 해야 하는가
parent: Unittest
grand_parent: Python
comments: true
categories: ["Programming", "Python3", "Testing"]
tag: ["Test", "Python", "Unittest", "Webservice"]
---

## 소프트웨어를 개발하는 과정

소프트웨어는 대략적으로 기획 -> 설계 -> 구현 -> 테스트 -> 배포 단계를 거쳐 완성해나간다고 알고있다. 이 중에서 테스트는 정말 애매한데, 언제, 얼만큼, 누굴 위해 작성해야 하는지 알려주는 사람을 본 적이 없기 때문이다. 게다가 테스트코드를 작성해야한다고 말하면 찬성하는 사람도 거의 없었다.

더군다나 AI기술이 소프트웨어 개발에 편입되면서 테스트코드의 중요성이 훨씬 높아졌다고 생각하기 시작하면서 테스트코드가 얼마나 중요한지 더 확신할 수 있게 되었다. 이 문서에는 내 역량의 한계로 테스트 기법이나 노하우 등은 담을 수 없고, 다만 몇년동안 테스트 코드에대해 고민해본 내용을 적당히 정리해보기위해 작성한다. 

## 테스트 코드는 누굴위해 만드는가

테스트 코드를 작성할 때 항상 드는 생각이 있었다. 어떤 코드를 테스트 해야 하는가. 폴더 구조에서 가장 상단에있는 소스 모듈부터 그냥 다 만들면 되는지. 작성중에 기획이 변경되거나 개발 계획이 틀어지거나, 개인적으로 코드 구현 과정에서 처음 생각한것과 달라졌을 때 테스트 코드를 어떻게 해야 할지.

특히나 현대의 웹서비스를 개발중일 때는 시장 트렌드도 변하고 요구도 변하고 사용자층도 너무나 빠르게 변하기 때문에 변경이 자주 발생하는 문제도 있다. 

흔히 테스트 코드를 작성할 때는 커버리지도 함께 측정해야 한다고들 한다. 그리고 이 커버리지를 신경써서 개발하다보면 반드시 코드의 예외 케이스를 함께 고려할 수밖에 없다. 왜냐하면 그 부분을 빼먹으면 커버리지가 오르지 않기 때문에. 만약 예외 케이스를 처리하는 코드를 삭제하면, 코드는 실행중에 발생하는 예외에 대처할 수 없기 때문에 미완성으로 출시되게 된다. 

그럼 이제 정리해볼 수 있다. 테스트는 요구사항을 안전하게 처리하기 위해 만드는 것이라고.

### 웹서비스의 경우 

프로그램은 반드시 User Interface가 있어야 한다. 그래야 사용자와 상호작용을 하면서 필요한 기능을 제대로 제공할 수 있기 때문이다. 웹서비스는 보통 3-tier에 layered architecture를 기본은로 하고 있는데, 각 layer 중에서도 서로 다른 플랫폼간의 데이터 교환이 발생하는 지점들이 있다. 일반적인 개발팀은 각 플랫폼 개발자들과 함께 그 지점들에 대한 원칙을 맞춘다. 이때 실제 개발해야하는 제품의 기능과 사용자층, 요구사항과 제약조건 들이 반드시 고려되어야 하기 때문에 이 시점에서 정상/비정상, 예상되는 예외케이스와 처리 절차 등을 정의하는 것이다. 

#### Backend 영역에서

다른 모든 프로그램에 있는 대원칙인 \[Input\] -> \[Processing\] -> \[Output\] 이 여기에서도 마찬가지로 적용되기 때문에, 우리는 이 \[Input\]과 \[Output\]을 우선 타겟으로 삼아서 테스트 코드를 만들어야 하는 것이다. 어떤 형식의 입력을 넣었을 때 어떤 출력이 나오는지 여기서 결정할 수 있기 때문이다. 할 수 있다면 이 지점을 처리하는 최종 모듈의 커버리지는 100%에 맞추는 것이 좋다. 

또 다른 지점은 DB와의 통신 구간이다. 여기는 코드가 자주 바뀌지 않지만, 오히려 자주 바꾸면 안되기때문에 변경을 감지하기위한 용도로 쓸 수 있다. 변경이 발생해서 테스트를 통과하지 못하면 변경했던 코드를 되돌려야 한다. 안그러면 코드를 변경하면서 DB를 함께 수정해야 하고, 이게 영향을 미칠 다른 위험요소를 반드시 고려해야 하기 때문에 개발시간이 말도안되게 늘어날 수 있기 때문이다. 

#### Frontend 영역에서

UI가 존재하는 이 영역은 컨텍 포인트가 크게 두군데이다. 하나는 사용자가 직접 접근하는 지점과 Backend 서버와 통신을 위한 API호출부분이다. 

## 
